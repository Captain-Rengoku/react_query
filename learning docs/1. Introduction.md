# 1. Introduction

## Problem Statement

- Since React is a UI library, there is no specific pattern for data fetching
- We typically use the useEffect hook for data fetching and useState hook to maintain component state like loading, error state or the resulting data
- If the data is needed throughout the app, then we tend to use state management libraries like Redux
- Most of the state management libraries are good for working with client state. Ex. 'theme' for an application / whether a modal is open
- State Management Libraries are not great for working with asynchronous or server state

### Client vs server state

- **Client state:**
  - Persisted in your app memory and accessing or updating it is synchronous

- **Server state:**
  - Persisted remotely and requires asynchronous APIs for fetching or updating
  - Has shared ownership
  - Data can be updated by someone else without your knowledge
  - UI data may not be in sync with the remote server/database data
  - Challenging when you have to deal with caching, deduplication of multiple requests for thsame data, updating stale data in the background, performance optimizations in pagination and lazy-loading, etc

## What is React Query?

- React Query is a powerful data-fetching and state management library for React applications.
- It provides a set of hooks for fetching, caching, synchronizing, and updating server state in your UI, without needing complex global state management solutions like Redux.

Created by Tanner Linsley, React Query simplifies remote data management by:

- Automatically caching fetched data
- Keeping data fresh via background refetching
- Avoiding duplicate network requests
- Simplifying pagination, infinite scrolling, and optimistic updates

## Why Use React Query?

Traditionally, managing server state involved juggling global stores (Redux, MobX), side effects (Redux-Thunk, Redux-Saga), and manual caching logic. React Query eliminates this complexity by abstracting most of this away, offering:

- ✅ **Auto caching and background syncing**
- 🔁 **Refetch on focus or reconnect**
- 💡 **Stale-while-revalidate logic**
- 🚀 **Performance optimization out of the box**
- 🔄 **Support for paginated and infinite queries**
- 💥 **Built-in retry and error recovery**
- 🔧 **DevTools for debugging query states**

React Query is especially useful in apps with a lot of asynchronous data (like dashboards, admin panels, and data-heavy UIs).

## Core Concepts Overview

Here are the fundamental building blocks of React Query:

- **Query (useQuery)**: Used to fetch and cache server data. Handles loading, error, and success states.
- **Mutation (useMutation)**: Used to send data to the server (e.g., POST, PUT, DELETE). Supports optimistic updates.
- **Query Keys**: Unique identifiers for queries; essential for caching and invalidation.
- **Query Client**: A central manager for all queries/mutations. Configures global settings like retry count and cache time.
- **DevTools**: Visual debugging tool to inspect the query cache, query states, and performance.

## Comparison with Redux & SWR

| Feature                | React Query          | Redux                          | SWR                       |
|------------------------|----------------------|--------------------------------|----------------------------|
| Purpose               | Server state mgmt     | Global app & server state mgmt | Server state mgmt         |
| Data Caching          | ✅ Built-in           | ❌ Manual                      | ✅ Built-in               |
| Background Refetching | ✅ Yes                | ❌ No                          | ✅ Yes                    |
| DevTools              | ✅ Yes                | ✅ (via Redux DevTools)       | ❌ No (community-based)   |
| Boilerplate           | Minimal               | High                           | Minimal                   |
| Optimistic Updates    | ✅ Yes                | ❌ Manual                      | 🚧 Limited                |
| Pagination Support    | ✅ Yes                | ❌ Manual                      | 🚧 Basic support          |
| Learning Curve        | Medium                | High                           | Low                       |

**Summary**:  
React Query is ideal when your app heavily interacts with remote data and you want to avoid over-engineering with global state libraries like Redux. It's more full-featured than SWR and offers deep control and performance optimizations for serious production use.

---
